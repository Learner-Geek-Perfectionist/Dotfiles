#!/bin/bash
# Chezmoi run_once è„šæœ¬ï¼šå®‰è£… Mise (ä»… Linux)
# æ­¤è„šæœ¬åœ¨ chezmoi apply æ—¶è‡ªåŠ¨è¿è¡Œï¼ˆä»…è¿è¡Œä¸€æ¬¡ï¼‰

{{ if eq .chezmoi.os "linux" }}
set -e

echo "ğŸš€ æ£€æŸ¥å¹¶å®‰è£… Mise..."

# æ£€æŸ¥ mise æ˜¯å¦å·²å®‰è£…
if command -v mise &>/dev/null; then
	echo "âœ… Mise å·²å®‰è£…: $(mise --version)"
	exit 0
fi

# å®‰è£… mise
echo "ğŸ“¦ å®‰è£… Mise..."
curl -fsSL https://mise.run | sh

# éªŒè¯å®‰è£…
if command -v mise &>/dev/null || [[ -x "$HOME/.local/bin/mise" ]]; then
	echo "âœ… Mise å®‰è£…æˆåŠŸ"
else
	echo "âŒ Mise å®‰è£…å¤±è´¥"
	exit 1
fi
{{ else }}
# macOS ä½¿ç”¨ Homebrew å®‰è£…å·¥å…·ï¼Œè·³è¿‡ Mise
echo "â„¹ï¸  macOS ç³»ç»Ÿï¼Œè·³è¿‡ Mise å®‰è£…ï¼ˆä½¿ç”¨ Homebrewï¼‰"
{{ end }}
